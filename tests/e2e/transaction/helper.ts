// Copyright Â© Aptos Foundation
// SPDX-License-Identifier: Apache-2.0

import {
  Account,
  Aptos,
  AccountAddress,
  UserTransactionResponse,
  TypeTag,
  EntryFunctionArgumentTypes,
  GenerateFeePayerRawTransactionInput,
  GenerateMultiAgentRawTransactionInput,
  HexInput,
} from "../../../src";
import { MoveVector } from "../../../src/bcs/serializable/moveStructs";
import { FUND_AMOUNT } from "../../unit/helper";

export async function publishModule(
  aptos: Aptos,
  senderAccount: Account,
  metadataBytes: HexInput,
  codeBytes: HexInput,
) {
  const rawTransaction = await aptos.generateTransaction({
    sender: senderAccount.accountAddress.toString(),
    data: {
      function: "0x1::code::publish_package_txn",
      functionArguments: [MoveVector.U8(metadataBytes), new MoveVector([MoveVector.U8(codeBytes)])],
    },
  });
  const signedTxn = await aptos.signTransaction({
    signer: senderAccount,
    transaction: rawTransaction,
  });
  const txnHash = await aptos.submitTransaction({
    transaction: rawTransaction,
    senderAuthenticator: signedTxn,
  });
  return (await aptos.waitForTransaction({ transactionHash: txnHash.hash })) as UserTransactionResponse;
}

export async function fundAccounts(aptos: Aptos, accounts: Array<Account>) {
  // eslint-disable-next-line no-restricted-syntax
  for (const account of accounts) {
    // eslint-disable-next-line no-await-in-loop
    await aptos.fundAccount({ accountAddress: account.accountAddress.toString(), amount: FUND_AMOUNT });
  }
}

// Transaction builder helpers
// single signer
export async function rawTransactionHelper(
  aptos: Aptos,
  publisherAccount: Account,
  senderAccount: Account,
  functionName: string,
  typeArgs: TypeTag[],
  args: Array<EntryFunctionArgumentTypes>,
): Promise<UserTransactionResponse> {
  const rawTransaction = await aptos.generateTransaction({
    sender: senderAccount.accountAddress.toString(),
    data: {
      function: `${senderAccount.accountAddress.toString()}::tx_args_module::${functionName}`,
      typeArguments: typeArgs,
      functionArguments: args,
    },
  });
  const senderAuthenticator = await aptos.signTransaction({
    signer: senderAccount,
    transaction: rawTransaction,
  });
  const transactionResponse = await aptos.submitTransaction({
    transaction: rawTransaction,
    senderAuthenticator,
  });
  const response = await aptos.waitForTransaction({
    transactionHash: transactionResponse.hash,
  });
  return response as UserTransactionResponse;
}

// multi agent/fee payer
export const rawTransactionMultiAgentHelper = async (
  aptos: Aptos,
  publisherAccount: Account,
  senderAccount: Account,
  functionName: string,
  typeArgs: Array<TypeTag>,
  args: Array<EntryFunctionArgumentTypes>,
  secondarySignerAccounts: Array<Account>,
  feePayerAccount?: Account,
): Promise<UserTransactionResponse> => {
  // TODO: Combine these to one type later. This should be possible but isn't right now due to typescript
  // compile time errors because it can't resolve the types
  const transactionData = {
    sender: senderAccount.accountAddress.toString(),
    data: {
      function: `${senderAccount.accountAddress.toString()}::tx_args_module::${functionName}`,
      typeArguments: typeArgs,
      functionArguments: args,
    },
  };
  const generatedTransaction = await (async () => {
    let transaction;
    if (secondarySignerAccounts.length === 0) {
      transaction = await aptos.generateTransaction({
        ...transactionData,
        feePayerAddress: feePayerAccount?.accountAddress.data,
      } as GenerateFeePayerRawTransactionInput);
    } else if (feePayerAccount === undefined) {
      transaction = await aptos.generateTransaction({
        ...transactionData,
        secondarySignerAddresses: secondarySignerAccounts.map((account) => account.accountAddress.data),
      } as GenerateMultiAgentRawTransactionInput);
    } else {
      transaction = await aptos.generateTransaction({
        ...transactionData,
        secondarySignerAddresses: secondarySignerAccounts.map((account) => account.accountAddress.data),
        feePayerAddress: feePayerAccount?.accountAddress.data,
      } as GenerateFeePayerRawTransactionInput);
    }
    return transaction;
  })();

  const senderAuthenticator = aptos.signTransaction({
    signer: senderAccount,
    transaction: generatedTransaction,
  });

  const secondaryAuthenticators = secondarySignerAccounts.map((account) =>
    aptos.signTransaction({
      signer: account,
      transaction: generatedTransaction,
    }),
  );

  let feePayerAuthenticator;
  if (feePayerAccount !== undefined) {
    feePayerAuthenticator = aptos.signTransaction({
      signer: feePayerAccount,
      transaction: generatedTransaction,
    });
  }

  const transactionResponse = await aptos.submitTransaction({
    transaction: generatedTransaction,
    senderAuthenticator,
    secondarySignerAuthenticators: {
      additionalSignersAuthenticators: secondaryAuthenticators,
      feePayerAuthenticator,
    },
  });

  const response = await aptos.waitForTransaction({ transactionHash: transactionResponse.hash });
  return response as UserTransactionResponse;
};

// hard-coded bytecode for the contract, so we don't have to recompile it every time in ci
export const ARGUMENT_TESTS_CONTRACT_METADATA =
  // eslint-disable-next-line max-len
  "0x25417267756d656e7420546573747320666f722074686520547970657363726970742053444b0100000000000000004038444130313539373642353830303230393331464643333145354633374144313541393535304542423746343746343639333743453938443646423542344236f2011f8b08000000000002ffa5903f4fc33010c5777f0acb7bd25662ed5009b13030902daaa2abf35c421a9f659b00427c77ec24441dba55f67277effdee4fed48f774c651581a20f7521dfcf963808db24288411af632be4156df0e41fbce45f9faf8acc4081f3ab6d9b12dd35342d42d1c6c0bab3b84a338b8c8e1c927ec27fb3e097fe485355db2a52c37eba7ac2b347b14bb251878c4c6fc5b97e41a2bf93bc32bee615f4eefd069d0bbf931d30a9e71b987a8a96d3d42c8db4c9ac65cada3b65f3bb5e4276fc3eb28a9f6a044f46403e998eed4d072d6a9daccd71a8bab0637c5fb043a01469381fa0357683d82ac010000010e74785f617267735f6d6f64756c65af1c1f8b08000000000002ffed5c6d6fe33612fede5fc1eb01a98dd3b516f562d9d92c9add18db00d9642f518a16412028369de8ea58ae256737d7ee7f3f8e244a24454a4cb71f8ac241124be4f099d190331c0e293fa68bdd8aa07c1bafb3789e27e93a8ab7f7bb47b2ceb3e934ff047759f45852fdf615a23fbb8ca02c5f4ca759be4dd6f7876221d96ed3ad549625f76b22173e9179dea24c3720c274fadb15592d2d7451dc7e9689eefe4bdb3644c5ad4c540a379d5ea984cc9f37244ad6cbb402a18d0b82efbefb0e850f0495b2a11559dfe70f198ab704add31c915f77f1eadb82729eaeb31c9d9ebfbdb8bc9cbd0da31fe9bf8bcbe86c76fe2efc618a76be8b8e903d1a1d0ab8c99aea81a13fc5ab1de900af207f3c3ebb9e5d45e7176134fbcff5f11903c73c78a92864a324a3606b82e2f58215625ab8fe26e7a12f3e84a717e725de69f87334bbbca49c460cdad14167e9e31f83b619b4ab84a64df338595365a045b25c922d1d7ea57e50fe10af6b76fd8c3063e401238efccdf1d5aca2797b71328b3e5cbf393b7d1b1d5fbebb7e3f3b0fafb83e6322aa1bbebf3e0b4fa3abd377e7b34bae2f843627b30f67173fcf2e29f15518bd3f0edffe10bdbf38b93e9b45c7272797b3ab9add98fe0872be3ffe29ba0e687500b89e7728d7d93eadb47d5aeb7b9ed3ae7740050e065de3893bf1c778d226f2dde8cde9bbfa9903d7f5c7ae3b1a3be3d1c4f36cdf56f0c541d5865ec120714738c08eef4ff068e204aeefd05f67ecfaa3b1ebd8633fc0b6ed2ae4c79e5fe1d02b606e7b630a114cb0337628e789e762c7a37204b40b033f184f46e3c073b03f995026bee7bb23f87326ae37f6023a9ec613dbb1f1c47726135007c76ff6d3076a43b393e8cdc505b59bbb345d5186f976470e5554b5da6d7575a379ac266854efa8097cb7b6030d0b1cd40af6d424546bb5ee7c25493dc4e2c5624bb28c127eaf74f0cad657e1e5e939ed9ed24bbdda05af69fbbbafc9a70d2d208ba874ac5fab155df9ac52df1502a81d3084db9ba21b2cb48c5719fd801b74cb3c03357a8296e96a957ea4aca8d7ccc93df59be0b5b3aabc22d93ec6f994b51a59c8b610b6609ca17f37177671d1212e74bcf0b8dccd4d038b3d07feb9f0cf63d26a1061ac3014dbe731e18e03052376ca0fb7fce8838651c6c01ccc43c31d075ddbbfc35dbbdc751f2718ae0cdb77794e70c7715238104759ea2a4b7b9589b90ea237823ab1d849666ec93125744d09fb9ea1305b2634bde19fa1b8e5d5f967ba44e74fc673ff64bc1ec5d5ceac5256e5d338f5d52537e8fbd127aa44fa3fbe9b179f0bb22c3e6dec149faee7179fe360d2cd56f2828d43e018f385370a1769d1322a48f14905293ea920c52715a4f8a4827c0d9214a2d076bb798eae48bedb9cc4798c1ee20cfd429eabc01b7ec8e3267f8eca0818a2aa32f87d3583e24b92a5bbed9cbcb6d4e4f865e44e27f967416481a2119b512d776beac593bc5a480c1664b34a9fc9768a0ecab5c1907bc438cbc836ffc7a0ac994eabfe8dd265dd6e888e74739a65107c0d0f6b662b9223fabc59d3abca67860ebe155b25b4c9a829faf890d0074bd02be4f00fc3a88b5106aa4ab7d1962c695bb68a996f499c934ae903f5437102734247a58638ac7b42ef01adac191c486c259cc7f48944793a100ae1e7a041b75a95625ffff659a4508bcac9588daee5367d8c24f1fae42d7b683addecb287e82e9eff323878dc95fd67c17f891c7a2841ff62e15c316a9b4b06b6254f649b91064a1a1d195863b400733ce24c53ec62d92c6b49d38d24e8d0d237c47fb4a163d890ad73b59dcf0c4ce4d5a8a029afb45419f86677b74ae6888ed5ed7361edc50a3b8fefb35721f5c8219dd7423ab185d40b877402093dfa473d7138a67f01fd9b004d410894369042041142c010da406d03b90df43634b0a1058616b8c08616e0e3430c2d30b4c0d002430b0c2df0e4f540e5668427e51203c565baa4f2433bea6f1475452c4b6b0f0e7a516c3d0a9d40cc307007060d2bcd409c0e10071b82b81d20be6b08e2753d0e36558adf8102819519ca588fc2e20b33a0400f54a6a20c71267a1cf50c65380c3b4633bf403385b37be1203c3204c3fd6074989ba239fd6874bc9ba2b9fd6874e09ba279064f8acd15e7f7c3812998c28d7be1984d948814a71f34e805adecc354ca492fa0da504c9d6d87a594f9c817590ab67be1cc2d05e37e30734bc14e3f9ab9a560b71fcddc52b067f0a4e69682fd7eb817580a1ef7c28996d28f18f422becc4cf0a417506b26621438328dfdca8266f5d28458513c9fa7bb7511221fc8eb0b4a1f814595895ab17c57a466a5b22a1f2b95564958a9b4cabcca082cdd2a95d73956b1bceacb3ab12ad6563b4ea8ec1fb1ae5afcf4adbf4bbf1515b13d9f926c51947ae227ec16c92ee844d84919ca368194676c1348e941050b396fd72669a5c55a24b5d2a5a9a745c8f42fce262d32d6159d7344d3aadc91645dd278ea1645d925fcccd022812ee94028ba8473df6d02e812ce23b709a04b3827ab60813919c42e61244597f0ceb045527789e4e35a84ac4b44cfd522abada3cb1f35ad68aa7f41e842f5395a930cf26d76d39b2582f28ef94dfa630146787172a1c7c41a4cf14398330c919d97206b7c739bd510c5f35f7709ed07659282ad769993851941d81eb37a7748692665c4e5467844d8353be237d28cd06c1d1aecb11d091b6f46785887075b7247c23e9d119ea3c3831dbc23615bcf08cfd53e2f96f407339209a2a7432cb6078fc45d4323445f83586f251eb5f6198d70c71adcd243002c3bb0b1cb97c140da8d1c1af108343c4af7023cee491e35c9acc1f05b316f67c465d2e21295269b45c5118e013f895bdc147c736b66152343064594a4dc7a35e3631bf2a1719762c7d48c0736e50126aed84435e3e2987201c357eca79a71714db9803b50eca59a71f18c358655fd62ea396cdf944fe13954db99667cc6867c5848addb0034e31618722b9d8d5538847adb4ea81b98f91cdbd41d943ea6e498d340a02ac82a6a437658e11cca208ab1e3e3550bb1f3747026accc339bb1b10dd9943e887181e3610321aa3064870dd9812b5233bb0e86960927c79413f81e0d2b6a3b668fe59a320317a461e660b307f34c798123d2f0f25d335ebeb112b1bec3689da11ac7a6ec0aa7a46147eb0cd90586ec6a8fa5e6c8f69acd984e0c9932c725f0ec0c9dcc047046ed4d71d41b3099c9cc5c9f20336cd79a49668be926bae8791bafbfc9d11d41f378b5220b047bc92846d97c9b6c72b4899f5769bc2888b9a4d43679829d7145566a9f94da27a5f649a97d52ea0f27a57a722ffa7cb8e07dacdad958957bb1984bb19817b198e3b06a5f61d5dec1e2fd81c599bfc599bba5385123ae552b11b8d51fbf48e39752fc82475896086b0739c0974270313e16a453c5b242c8c905847cc4c607547cc023042442b8204fe6d23cdb92ee853b20d1e36e95279b153b98653af95475b8a3cee9a8733bea3c455d79cf7441badcdb7e5edccf8bfb79713f2f7ec9bc589cae945c4eb48195c4826e54ab0e788ba712dbe7836b672a6d5d7790627352c79cd43527f538d2db9e5c92ac2dab437f56e79b6b43ee24e83e3ef99bc727c97a95ac491199a886d5ab708a16db74f31a7295dc666af8ba787a6e2b144aa0ab92f5827c2ae668d5895a7614b97c7d96361a1c14c0c531144d25354354bc3a3c9d26eba77895c05b1474bd3ed0bc624b1303b520c361fb54f7ff92cdabd04261f54cd58358e8f7d84277bf4ba7b7ebcd2210f04e238892dde73e450b091178daaac3ecda81824eab422c14ea159d2cd1802553922c2a92bba048863d1c6a1eb0a391b60334ef0aeb3ae03322ab8cf4f38724d017f0b775fcd9c44256049c19bc785031bd4b29fc475151879d62b2d7921b212d86fb3269b1565bfce8f9e7cd53423edef24b0a18495018d144973275b50fc3f761f83e0cdf87e19d61f814351e43f413bc7f10dc82e00d0427209abe64f0b28dcb766d64cb2adb531bac925265994a6b545aa0dae8d476a6b52b9d21f55a8e6aa4abcda38352548072ec2bc7bb7a88ab47b57614eb86add172b1891aa435085b78b44af901cc4d728a427e4073539caa3956810a035d9addda159934f0c549ad6391a3aa693f7ab3f85116cb0ae01645ca72590dfc624959d15286b48852d5a95462bab852d5b4b5d22cba94c5b256b8c598b25cd60abf485356b4b4222dde54752aade8167506c162d78116799ae7cc8d2d9b1ee3cd40fd2a3c5d3a65f2ba49d877ce86dcaa48b32892b793690e5a95182a23f5e87e95ded145534df15af776b4a15ef86337c07ba09e8dd04b8a4d525cfc0bc4b2060e351eafa191cf281a916133324733b8a42e539e57ea890625250c9a3396b588ecca19568a113be8d06cf24437a80b1bddbe7c7434e9b4629834192be9c2a0f3bfe8b9c52121bd405fc920a96370c0184a19c897b5c65fd49a4f944ac6098f5a7f8dc391ee2b1caaac263e82aff2a86f1db8bdab6f5db89dd7b71edc2e2c344fb7042eede16dfddd13858261094d6f0a66dc12baf55d14adfd30acaf72f455aebe4ab5f706624bc53dc3abfe36bb2589f31da5120ff054a57488b17af87e08aa865db2104659533d7f88d7f724aa0aa2e52abecf062018cb82de5455b775c12d9f4806b64c9dcd8971d4f5451e87aadd00dcdd9851a91b3b468d1d7563d7a8b1ab6eec1935f6788da9be14c53c35affeb606f1b50e75d575a0ab908324e1ad094d8d1c28892f3268aa5ac152ebbd027dacd17a3d4020ed3be5af8840abf3f96a79f893f59d145aad7207dabb09b43ae68e91f7b0c07d42e8152f9db86e29557b52ba45a93ee1ac087285a3c9ca7ad5a162034238106c420687794de81c6c46e7bb867cb1a180c5c15503c2fabca99eb6e79ca8be618f450d858da7c679e98f5ceebdd7de7bedbdd7de7bfdf5bc17bbd486601d67f9f45e8d85acca524759ea2a4b3da5fd735f8128c7df562ba8b65a91b2d50a7fad564c6ba1dbbda3de3beabda3de3beabf8ea3a669a5cf5ffd1f864aeb78c360000000000400000000000000000000000000000000000000000000000000000000000000010e4170746f734672616d65776f726b00000000000000000000000000000000000000000000000000000000000000010b4170746f735374646c696200000000000000000000000000000000000000000000000000000000000000010a4d6f76655374646c69620000000000000000000000000000000000000000000000000000000000000004114170746f73546f6b656e4f626a6563747300";

const ACCOUNT_PUBLISH_PAYLOAD_GENERATED_WITH = "0a56e8b03118e51cf88140e5e18d1f764e0a1048c23e7c56bd01bd5b76993451";

// interpolate a named address into the contract bytecode
export async function getContractBytecode(deploymentAddress: AccountAddress) {
  let firstString =
    // eslint-disable-next-line max-len
    "0xa11ceb0b060000000c0100100210200330a00104d001f80105c803f70707bf0b950408d40f40069410aa0710be1782020ac0191a0cda19ac240d863e06000001010102010301040105010601070008080000090800050a0700020d07010001031007010000021d020006290700000b000100000c000200000e000300000f040000001105000000120500000013060000001400001e0000000000000000000000000000000000000000000000000000000000000015070700071a0b000100051b0a0900021c0d0e0108041e040e00021f0e1200022013140002211315010801221818000323001e010003241f19010003251f19010003261f2001000327211901000328221e0100062a00250100090a0b0c0f0c091109170919091a091b0918091c091d090e090911171217131714171517161912191319141915191617161a121a131a141a151a161b121b131b141b151b16181218131814181518161c121c131c141c151c161d121d131d141d151d160e120e130e140e150e160912091309140915091611121113111411151117221719172617171727171a1728171b17291718172a171c172b171d172c170e172d1709172e1711172f17301731170a17321733173417351736173717381739173a173b173c173d173e1701173f1740174117421743174417451746174717481749174a174b174c174d174e174f1750175117521753175400010a080203050505030b030108000b030108000b0301080001060c21060c01020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b0301080026060c060c060c060c060c0a0501020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108002001020d0e03040f0508020b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b0301080007070a08020a02030a08020a020a0a020a0a02010802010a0201070a090001080001060b03010900010501060801060805030b030108000c0a0b030108000801010b0301080001080501060805010c010b0301090089010a0b0301080003030303030303030303030303030303030303030303060206010602060d060e06030604060f0605060802060b0301080003030303030303030303030b030108000b030108000b030108000b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108000b0401020b0401010b0401020b04010d0b04010e0b0401030b0401040b04010f0b0401050b040108020b04010b030108000a020a020a010a010a020a020a0d0a0d0a0e0a0e0a030a030a040a040a0f0a0f0a050a050a08020a08020a0b030108000a0b030108000a020a020a010a010a020a020a0d0a0d0a0e0a0e0a030a030a040a040a0f0a0f0a050a050a08020a08020a0b030108000a0b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b030108000a020a010a020a0d0a0e0a030a040a0f0a050a08020a0b03010800010201030101010d010e0104010f010b0401090001060b040109000106090002060b040109000609000109000903030a050a050a050a050a050a050a051d010101010101010101010101010101010101010101010101010101010101080601090101090201090301090401090501090601090701090801090901090a010a0101090b01090c010a0d01090d010a0e01090e010a0301090f010a04010910010a0f010911010a05010912010913010a0b03010800010914010b040101010915010b040102010916010b04010d010917010b04010e010918010b040103010919010b04010401091a010b04010f01091b010b04010501091c010b0401080201091d010b04010b030108000e74785f617267735f6d6f64756c65056572726f72066f626a656374066f7074696f6e067369676e657206737472696e6709747970655f696e666f06766563746f720d456d7074795265736f757263650953657475704461746106537472696e671a6765745f65787065637465645f766563746f725f737472696e67196765745f746573745f6f626a6563745f616464726573736573064f626a656374106765745f746573745f6f626a656374730b696e69745f6d6f64756c65064f7074696f6e11707269766174655f617267756d656e7473107075626c69635f617267756d656e7473217075626c69635f617267756d656e74735f6d756c7469706c655f7369676e65727309747970655f7461677312766965775f616c6c5f617267756d656e74730b64756d6d795f6669656c640e656d7074795f6f626a6563745f310e656d7074795f6f626a6563745f320e656d7074795f6f626a6563745f33077265766572736504757466380e6f626a6563745f616464726573730e436f6e7374727563746f725265660a616464726573735f6f660d6372656174655f6f626a6563740f67656e65726174655f7369676e65721b6f626a6563745f66726f6d5f636f6e7374727563746f725f7265660d696e76616c69645f7374617465046e6f6e650769735f6e6f6e650769735f736f6d6506626f72726f7708636f6e7461696e7304736f6d650854797065496e666f07747970655f6f660a56e8b03118e51cf88140e5e18d1f764e0a1048c23e7c56bd01bd5b7699345100000000000000000000000000000000000000000000000000000000000000010308d007000000000000030810270000000000000308611e00000000000005200a56e8b03118e51cf88140e5e18d1f764e0a1048c23e7c56bd01bd5b769934510101010a02100f65787065637465645f737472696e670410050000000000000000000000000000000d0202000f2006000000000000000000000000000000000000000000000000000000000000000e0403000000030804000000000000000201010a05c1010600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000abc0000000000000000000000000000000000000000000000000000000000000def0000000000000000000000000000000000000000000000000000000000000123000000000000000000000000000000000000000000000000000000000000045600000000000000000000000000000000000000000000000000000000000007890a0104030100010a0a0225060f65787065637465645f737472696e6703616263036465660331323303343536033738390a046106000000000000000000000000000000000100000000000000000000000000000002000000000000000000000000000000fdfffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0a0d0d06000001000200fdfffeffffff0a0fc10106000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000fdfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0a0e1906000000000100000002000000fdfffffffeffffffffffffff0a033106000000000000000001000000000000000200000000000000fdfffffffffffffffeffffffffffffffffffffffffffffff0a020706000102fdfeff030864000000000000000410ffffffffffffffffffffffffffffffff0d02ffff0f20ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0e04ffffffff0308ffffffffffffffff0201ff03082c01000000000000030890010000000000000308f4010000000000000308c8000000000000000a020100126170746f733a3a6d657461646174615f7631ed010601000000000000000b45585045435445445f55380002000000000000000c45585045435445445f5531360003000000000000000c45585045435445445f5533320004000000000000000c45585045435445445f5536340005000000000000000d45585045435445445f553132380006000000000000000d45585045435445445f55323536000004106765745f746573745f6f626a6563747301010012766965775f616c6c5f617267756d656e7473010100196765745f746573745f6f626a6563745f6164647265737365730101001a6765745f65787065637465645f766563746f725f737472696e670101000002011601010203170b03010800180b03010800190b03010800000100000824400900000000000000000c03070e0c050d0538000b050c060e06410a0c020a0206000000000000000024042005100d06450a0c010d030c000b010c040b000b04110a44090b02060100000000000000170c02050b0b06460a00000000000000000b03020101000101030b11020c020c010c000e0038010e0138010e0238010202010001010f0d07032b010c000a001000140a001001140b00100214020300000010360a00110c0703210406050a0b0001070227401100000000000000000c050600000000000000000c020a0206030000000000000023042805130703110d0c010e01110e0c040e040912002d000e0138020c030d050b0344110b02060100000000000000160c02050e0d0538030d0545110d0545110d05451112010c060b000b062d0102040004010100230b000b010b020b030b040b050b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0b20110502050104010116b20a0b0107042104050509070106000000000000000016270b02070b21040e0512070106010000000000000016270b030707210417051b070106020000000000000016270b0407092104200524070106030000000000000016270b05070a210429052d070106040000000000000016270b0607062104320536070106050000000000000016270b07070821043b053f070106060000000000000016270b0807032104440548070106070000000000000016270b090705110a21044e0552070106080000000000000016270b0a07032b0110001421045a055e070106090000000000000016270b0b07200701060a00000000000000160c220c9f010c94010e940141170e9f01411721046d057207150b22161110270b94010b9f010c7e0c680d6838040d7e38040b680b7e0c7f0c690e6941170c430a430e7f411721048701058901060200020000000000270a4306000000000000000024049d01058e010d6945170d7f4517210495010598010b221110270b43060100000000000000170c430589010b69461700000000000000000b7f461700000000000000000b0c070d0701060b00000000000000160c230ca0010c95010e950141190ea00141192104b00105b50107150b23161110270b95010ba0010c80010c6a0d6a38050d800138050b6a0b80010c81010c6b0e6b41190c440a440e810141192104ca0105cc01060200020000000000270a440600000000000000002404e00105d1010d6b45190d810145192104d80105db010b231110270b44060100000000000000170c4405cc010b6b461900000000000000000b8101461900000000000000000b0d07140701060c00000000000000160c240ca1010c96010e960141170ea10141172104f30105f80107150b24161110270b96010ba1010c82010c6c0d6c38040d820138040b6c0b82010c83010c6d0e6d41170c450a450e8301411721048d02058f02060200020000000000270a450600000000000000002404a3020594020d6d45170d8301451721049b02059e020b241110270b45060100000000000000170c45058f020b6d461700000000000000000b8301461700000000000000000b0e07100701060d00000000000000160c250ca2010c97010e9701411a0ea201411a2104b60205bb0207150b25161110270b97010ba2010c84010c6e0d6e38060d840138060b6e0b84010c85010c6f0e6f411a0c460a460e8501411a2104d00205d202060200020000000000270a460600000000000000002404e60205d7020d6f451a0d8501451a2104de0205e1020b251110270b46060100000000000000170c4605d2020b6f461a00000000000000000b8501461a00000000000000000b0f07120701060e00000000000000160c260ca3010c98010e9801411b0ea301411b2104f90205fe0207150b26161110270b98010ba3010c86010c700d7038070d860138070b700b86010c87010c710e71411b0c470a470e8701411b21049303059503060200020000000000270a470600000000000000002404a903059a030d71451b0d8701451b2104a10305a4030b261110270b47060100000000000000170c470595030b71461b00000000000000000b8701461b00000000000000000b1007130701060f00000000000000160c270ca4010c99010e990141180ea40141182104bc0305c10307150b27161110270b99010ba4010c88010c720d7238080d880138080b720b88010c89010c730e7341180c480a480e890141182104d60305d803060200020000000000270a480600000000000000002404ec0305dd030d7345180d890145182104e40305e7030b271110270b48060100000000000000170c4805d8030b73461800000000000000000b8901461800000000000000000b11070f0701061000000000000000160c280ca5010c9a010e9a01411c0ea501411c2104ff0305840407150b28161110270b9a010ba5010c8a010c740d7438090d8a0138090b740b8a010c8b010c750e75411c0c490a490e8b01411c21049904059b04060200020000000000270a490600000000000000002404af0405a0040d75451c0d8b01451c2104a70405aa040b281110270b49060100000000000000170c49059b040b75461c00000000000000000b8b01461c00000000000000000b1207110701061100000000000000160c290ca6010c9b010e9b01411d0ea601411d2104c20405c70407150b29161110270b9b010ba6010c8c010c760d76380a0d8c01380a0b760b8c010c8d010c770e77411d0c4a0a4a0e8d01411d2104dc0405de04060200020000000000270a4a0600000000000000002404f20405e3040d77451d0d8d01451d2104ea0405ed040b291110270b4a060100000000000000170c4a05de040b77461d00000000000000000b8d01461d00000000000000000b13070c0701061200000000000000160c2a0ca7010c9c010e9c01410e0ea701410e21048505058a0507150b2a161110270b9c010ba7010c8e010c780d78380b0d8e01380b0b780b8e010c8f010c790e79410e0c4b0a4b0e8f01410e21049f0505a105060200020000000000270a4b0600000000000000002404b50505a6050d79450e0d8f01450e2104ad0505b0050b2a1110270b4b060100000000000000170c4b05a1050b79460e00000000000000000b8f01460e00000000000000000b1411000701061300000000000000160c2b0ca8010c9d010e9d0141090ea80141092104c80505cd0507150b2b161110270b9d010ba8010c90010c7a0d7a380c0d9001380c0b7a0b90010c91010c7b0e7b41090c4c0a4c0e910141092104e20505e405060200020000000000270a4c0600000000000000002404f80505e9050d7b45090d910145092104f00505f3050b2b1110270b4c060100000000000000170c4c05e4050b7b460900000000000000000b9101460900000000000000000b150c2111020c510c500c4f0b210b4f0b500b51401103000000000000000701061400000000000000160c2c0ca9010c9e010e9e0141110ea90141112104940605990607150b2c161110270b9e010ba9010c92010c7c0d7c38030d920138030b7c0b92010c93010c7d0e7d41110c4d0a4d0e930141112104ae0605b006060200020000000000270a4d0600000000000000002404c40605b5060d7d45110d930145112104bc0605bf060b2c1110270b4d060100000000000000170c4d05b0060b7d461100000000000000000b9301461100000000000000000b16380d0701061500000000000000160c2d0c5d0c520e52380e04dd060e5d380e04d70605dc06071c0b2d1611102705f3060e5d380f04e10605e606071d0b2d161110270e5238100c380e5d0b38381104ee0605f306071e0b2d161110270b17070438120701061600000000000000160c2e0c5e0c530e5338130489070e5e3813048307058807071c0b2e16111027059f070e5e3814048d07059207071d0b2e161110270e5338150c390e5e0b393816049a07059f07071e0b2e161110270b18070b38170701061700000000000000160c2f0c5f0c540e54380e04b5070e5f380e04af0705b407071c0b2f1611102705cb070e5f380f04b90705be07071d0b2f161110270e5438100c3a0e5f0b3a381104c60705cb07071e0b2f161110270b19070738180701061800000000000000160c300c600c550e55381904e1070e60381904db0705e007071c0b301611102705f7070e60381a04e50705ea07071d0b30161110270e55381b0c3b0e600b3b381c04f20705f707071e0b30161110270b1a0709381d0701061900000000000000160c310c610c560e56381e048d080e61381e048708058c08071c0b311611102705a3080e61381f049108059608071d0b31161110270e5638200c3c0e610b3c3821049e0805a308071e0b31161110270b1b070a38220701061a00000000000000160c320c620c570e57382304b9080e62382304b30805b808071c0b321611102705cf080e62382404bd0805c208071d0b32161110270e5738250c3d0e620b3d382604ca0805cf08071e0b32161110270b1c070638270701061b00000000000000160c330c630c580e58382804e5080e63382804df0805e408071c0b331611102705fb080e63382904e90805ee08071d0b33161110270e58382a0c3e0e630b3e382b04f60805fb08071e0b33161110270b1d0708382c0701061c00000000000000160c340c640c590e59382d0491090e64382d048b09059009071c0b341611102705a7090e64382e049509059a09071d0b34161110270e59382f0c3f0e640b3f383004a20905a709071e0b34161110270b1e070338310701061d00000000000000160c350c650c5a0e5a383204bd090e65383204b70905bc09071c0b351611102705d3090e65383304c10905c609071d0b35161110270e5a38340c400e650b40383504ce0905d309071e0b35161110270b1f0705110a38360701061e00000000000000160c360c660c5b0e5b383704ea090e66383704e40905e909071c0b361611102705800a0e66383804ee0905f309071d0b36161110270e5b38390c410e660b41383a04fb0905800a071e0b361611102707032b011000140c4e0b200b4e383b0701061f00000000000000160c370c670c5c0e5c383c049b0a0e67383c04950a059a0a071c0b371611102705b10a0e67383d049f0a05a40a071d0b37161110270e5c383e0c420e670b42383f04ac0a05b10a071e0b371611102702060104010123760a00110c0b01110c0b02110c0b03110c0b04110c400e05000000000000000c280b050b2807000c260c2e0c2d0e2d410e0e2e410e21041905200b000107150b26161110270b2d0b2e0c2b0c290d29380b0d2b380b0b290b2b0c2c0c2a0e2a410e0c270a270e2c410e21043505390b0001060200020000000000270a2706000000000000000024044f053e0d2a450e0d2c450e210445054a0b00010b261110270b27060100000000000000170c2705390b2a460e00000000000000000b2c460e00000000000000000b000b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0b200b210b220b230b240b2511050207010400248d023840384121040938423843210c00050b090c000b00041238443845210c0b0514090c0b0b0b041b38463847210c16051d090c160b16042438483849210c170526090c170b17042d384a384b210c18052f090c180b180436384c384d210c190538090c190b19043f384e384f210c1a0541090c1a0b1a044838503851210c1b054a090c1b0b1b045138523853210c1c0553090c1c0b1c045a38543855210c01055c090c010b01046338563857210c020565090c020b02046c38583859210c03056e090c030b030475385a385b210c040577090c040b04047e385c385d210c05058001090c050b05048701385e385f210c06058901090c060b0604900138603861210c07059201090c070b0704990138623863210c08059b01090c080b0804a20138643865210c0905a401090c090b0904ab0138663867210c0a05ad01090c0a0b0a04b40138683869210c0c05b601090c0c0b0c04bd01386a386b210c0d05bf01090c0d0b0d04c601386c386d210c0e05c801090c0e0b0e04cf01386e386f210c0f05d101090c0f0b0f04d80138703871210c1005da01090c100b1004e10138723873210c1105e301090c110b1104ea0138743875210c1205ec01090c120b1204f30138763877210c1305f501090c130b1304fc0138783879210c1405fe01090c140b14048502387a387b210c15058702090c150b15048a02058c0206000000000000000027020801000000210b000b010b020b030b040b050b060b070b080b090b0a0b0b0b0c0b0d0b0e0b0f0b100b110b120b130b140b150b160b170b180b190b1a0b1b0b1c0b1d0b1e0b1f0201000101010200";
  let secondString = "";
  // replaceAll
  while (firstString !== secondString) {
    secondString = firstString;
    // replaces the address used to generate the publish payload with the CLI, this one being `0a56...3451`
    firstString = firstString.replace(
      ACCOUNT_PUBLISH_PAYLOAD_GENERATED_WITH,
      deploymentAddress.toStringWithoutPrefix(),
    );
  }
  return secondString;
}

export async function publishArgumentTestModule(
  aptos: Aptos,
  publisherAccount: Account,
): Promise<UserTransactionResponse> {
  const contractBytecode = await getContractBytecode(publisherAccount.accountAddress);
  const response = await publishModule(aptos, publisherAccount, ARGUMENT_TESTS_CONTRACT_METADATA, contractBytecode);
  return response;
}

export const singleSignerScriptBytecode =
  // eslint-disable-next-line max-len
  "a11ceb0b060000000701000402040a030e0c041a04051e20073e30086e2000000001010204010001000308000104030401000105050601000002010203060c0305010b0001080101080102060c03010b0001090002050b00010900000a6170746f735f636f696e04636f696e04436f696e094170746f73436f696e087769746864726177076465706f7369740000000000000000000000000000000000000000000000000000000000000001000001080b000b0138000c030b020b03380102";

export const multiSignerScriptBytecode =
  // eslint-disable-next-line max-len
  "a11ceb0b060000000701000402040a030e18042608052e4307713e08af01200000000101020401000100030800010403040100010505060100010607040100010708060100000201020202030207060c060c0303050503030b000108010b000108010b0001080101080102060c03010b0001090002070b000109000b000109000002070b000109000302050b000109000a6170746f735f636f696e04636f696e04436f696e094170746f73436f696e087769746864726177056d657267650765787472616374076465706f73697400000000000000000000000000000000000000000000000000000000000000010000011a0b000a0238000c070b010a0338000c080d070b0838010d070b020b03160b061738020c090b040b0738030b050b09380302";

export async function publishTransferPackage(aptos: Aptos, senderAccount: Account) {
  await publishModule(
    aptos,
    senderAccount,
    // eslint-disable-next-line max-len
    "107472616e73616374696f6e5f746573740100000000000000004035364643333939394442364244363842383430304539323438363839393837413338313439344644413241343631334144373946333630323134353539324545ba011f8b08000000000002ff5d8f3d0ec2300c85779f0265e944032b12030b97a8aaca4d4c1b95fc284e0bc72729a503f2e2a7f7d97e6e02aa09076ac1a1a5c3f5205244c7a892f1ae4bc449c04291b32ae6a9ce25001a4d819c26a70c717d0bc9f33de6052f1fa7160693325c8d2905be4899e538f7b5f25662218f4fec796b958f5467a082484b19b2685c053cf7dac4a2bf98f50bc9c7efc236bbeb2a0742ad233113b7b0baddeeaeb9df6701ff9f15a3131fec1509190201000001087472616e73666572ca021f8b08000000000002ff9552cb4ec33010bcf72bf654a522dc10071790101f12b9f1a6582476e407a142fd77fc48d23826125891627b661fb39e4e32db22184585a6b5e1525406b52124dc34a8e07b07e03eab11686fa4ae1a453b1ca4fa20245ed4928be33629c03b87f6f6d4f21a50187581c60a3083ac4e97cafd0a07c7d570e5cac35ef3b34055cef71a6b29d82f00eda415a61ae3ece343064da109c6f41c431953a8758a4d413988bdd43c2f780893f2ab45035e74a4c07338103270f3ce141d9e6e5323e4d5efdfdcf6a508ec32d17338ae53c6b6fe9c33d2cb741287f01a7e457e87ea8cc5beb3cbb6cb65bd5bc45623f8e50c539b3ccb520edca58dc07d3acd75632358cc6f552e52cfb3c9b993ea5481e75e6381dc89a3db8b85df0443b5e9b7959b14d61c3f3d3ff14bee897fbc9caf3fcd6f43ec54364a9d355e7f00fb8d2dcfd603000000000300000000000000000000000000000000000000000000000000000000000000010e4170746f734672616d65776f726b00000000000000000000000000000000000000000000000000000000000000010b4170746f735374646c696200000000000000000000000000000000000000000000000000000000000000010a4d6f76655374646c696200",
    // eslint-disable-next-line max-len
    `a11ceb0b060000000801000602060a031022043208053a4e0788015208da01400c9a024c000001010102020404010001010508000000000100000302010002060506010002070701010002080901010002090a060100020403040404050403060c03050007060c060c0303050503010b0001080101080102060c03010b0001090002050b00010900030b000108010b000108010b0001080102070b000109000b0001090002070b0001090003087472616e736665720a6170746f735f636f696e04636f696e0a74776f5f62795f74776f04436f696e094170746f73436f696e087769746864726177076465706f736974056d657267650765787472616374${senderAccount.accountAddress.toStringWithoutPrefix()}00000000000000000000000000000000000000000000000000000000000000010001040003080b000b0138000c030b020b0338010201010400081a0b000a0238000c070b010a0338000c080d070b0838020d070b020b03160b061738030c090b040b0738010b050b0938010200`,
  );
}
